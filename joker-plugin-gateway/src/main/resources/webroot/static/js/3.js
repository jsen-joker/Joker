webpackJsonp([3],{M4Js:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("//Fk"),s=n.n(a),o=n("Dd8w"),r=n.n(o),i=n("QyUb"),l=n("/dzA"),c={name:"dashboard",data:function(){return{tableData:[]}},mounted:function(){this.fetchData()},computed:{},methods:{filterTag:function(e,t){return t.tag===e},fetchData:function(){var e=this;Object(l.b)(i.a.app.list).then(function(t){if(0===t.code){e.$message({message:"获取应用成功",type:"success"});var n=t.data.map(function(e){var t=JSON.parse(e.metas);return delete t.apis,r()({id:e.id,tag:e.on?"运行中":"未运行"},t,{on:e.on,metas:JSON.parse(e.metas)})});console.log(n),e.tableData=n}else e.$message({message:t.msg,type:"warning"})})},deploy:function(e,t){var n=this,a=t.metas;Object(l.c)(i.a.app.deploy,"",a).then(function(e){0===e.code?(n.$message({message:"部署应用"+a.name+"成功",type:"success"}),t.on=!0,t.tag="运行中"):n.$message({message:e.msg,type:"warning"})})},unDeploy:function(e,t){var n=this,a=t.metas;return Object(l.a)(i.a.app.undeploy+a.name).then(function(e){return 0===e.code?(n.$message({message:"关闭应用"+a.name+"成功",type:"success"}),t.on=!1,t.tag="未运行",!0):(n.$message({message:e.msg,type:"warning"}),!1)})},deleteApp:function(e,t){var n=this;this.$confirm("确认删除APP，将无法恢复？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){new s.a(function(a){t.on?n.unDeploy(e,t).then(function(e){return a(e)}):a(!0)}).then(function(a){a&&Object(l.a)(i.a.app.del+t.id).then(function(t){0===t.code?(n.$message({message:"删除应用成功",type:"warning"}),n.tableData.splice(e,1)):n.$message({message:t.msg,type:"warning"})})})}).catch(function(){})}}},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dashboard"},[n("el-card",{attrs:{shadow:"never"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.$router.push("/app/create")}}},[e._v("创建应用")])],1),e._v(" "),n("div",{staticClass:"hold"}),e._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{prop:"name",label:"应用名字",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"host",label:"域名",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"port",label:"端口",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"remark",label:"简述"}}),e._v(" "),n("el-table-column",{attrs:{prop:"tag",label:"标签",width:"100",filters:[{text:"未运行",value:"未运行"},{text:"运行中",value:"运行中"}],"filter-method":e.filterTag,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{type:"未运行"===t.row.tag?"primary":"success","disable-transitions":""}},[e._v(e._s(t.row.tag))])]}}])}),e._v(" "),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button-group",[t.row.on?e._e():n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){e.$router.push({path:"/app/edit",query:t.row})}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:function(n){e.$router.push({path:"/app/apis",query:{id:t.row.id,on:t.row.on}})}}},[e._v("编辑API")]),e._v(" "),t.row.on?e._e():n("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(n){e.deploy(t.$index,t.row)}}},[e._v("启动")]),e._v(" "),t.row.on?n("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(n){e.unDeploy(t.$index,t.row)}}},[e._v("关闭")]):e._e(),e._v(" "),t.row.on?e._e():n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){e.deleteApp(t.$index,t.row)}}},[e._v("删除")])],1)]}}])})],1)],1)},staticRenderFns:[]};var p=n("VU/8")(c,u,!1,function(e){n("w0BQ")},"data-v-a82b6d86",null);t.default=p.exports},w0BQ:function(e,t){}});