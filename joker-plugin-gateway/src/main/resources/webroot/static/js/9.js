webpackJsonp([9],{M4Js:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("//Fk"),s=a.n(n),o=a("Dd8w"),r=a.n(o),i=a("QyUb"),l=a("/dzA"),c={name:"dashboard",data:function(){return{tableData:[]}},mounted:function(){this.fetchData()},computed:{},methods:{filterTag:function(e,t){return t.tag===e},fetchData:function(){var e=this;Object(l.b)(i.a.app.list).then(function(t){if(0===t.code){e.$message({message:"获取应用成功",type:"success"});var a=t.data.map(function(e){var t=JSON.parse(e.metas);return delete t.apis,r()({id:e.id,tag:e.on?"运行中":"未运行"},t,{on:e.on,metas:JSON.parse(e.metas)})});console.log(a),e.tableData=a}else e.$message({message:t.msg,type:"warning"})})},deploy:function(e,t){var a=this,n=t.metas;Object(l.c)(i.a.app.deploy,"",n).then(function(e){0===e.code?(a.$message({message:"部署应用"+n.name+"成功",type:"success"}),t.on=!0,t.tag="运行中"):a.$message({message:e.msg,type:"warning"})})},unDeploy:function(e,t){var a=this,n=t.metas;return Object(l.a)(i.a.app.undeploy+n.name).then(function(e){return 0===e.code?(a.$message({message:"关闭应用"+n.name+"成功",type:"success"}),t.on=!1,t.tag="未运行",!0):(a.$message({message:e.msg,type:"warning"}),!1)})},deleteApp:function(e,t){var a=this;new s.a(function(n){t.on?a.unDeploy(e,t).then(function(e){return n(e)}):n(!0)}).then(function(n){n&&Object(l.a)(i.a.app.del+t.id).then(function(t){0===t.code?(a.$message({message:"删除应用成功",type:"warning"}),a.tableData.splice(e,1)):a.$message({message:t.msg,type:"warning"})})})}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dashboard"},[a("el-card",{attrs:{shadow:"never"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.$router.push("/app/create")}}},[e._v("创建应用")])],1),e._v(" "),a("div",{staticClass:"hold"}),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"name",label:"应用名字",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"host",label:"域名",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"port",label:"端口",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"path",label:"路径"}}),e._v(" "),a("el-table-column",{attrs:{prop:"tag",label:"标签",width:"100",filters:[{text:"未运行",value:"未运行"},{text:"运行中",value:"运行中"}],"filter-method":e.filterTag,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"未运行"===t.row.tag?"primary":"success","disable-transitions":""}},[e._v(e._s(t.row.tag))])]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",[t.row.on?e._e():a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.$router.push({path:"/app/edit",query:t.row})}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.$router.push({path:"/app/apis",query:{id:t.row.id,on:t.row.on}})}}},[e._v("编辑API")]),e._v(" "),t.row.on?e._e():a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){e.deploy(t.$index,t.row)}}},[e._v("启动")]),e._v(" "),t.row.on?a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(a){e.unDeploy(t.$index,t.row)}}},[e._v("关闭")]):e._e(),e._v(" "),t.row.on?e._e():a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.deleteApp(t.$index,t.row)}}},[e._v("删除")])],1)]}}])})],1)],1)},staticRenderFns:[]};var p=a("VU/8")(c,u,!1,function(e){a("VFkB")},"data-v-211a2ac1",null);t.default=p.exports},VFkB:function(e,t){}});