webpackJsonp([6],{nE2D:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("mvHQ"),n=r.n(o),a=r("QyUb"),l=r("/dzA"),p=["ALL","GET","POST","DELETE","PUT","OPTIONS","HEAD","TRACE","CONNECT","PATCH","OTHER"],s={"HTTP请求":"HTTP","URL跳转请求":"REDIRECT"},i={name:"apiCreate",data:function(){return{methods:p,requestType:s,form:{name:"",path:"",apiType:"",supportMethods:["ALL"],supportContentType:"",remark:"",apiOption:{apiOptionUrls:[{url:""}]}},rules:{name:[{required:!0,message:"请输入API名字",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],path:[{required:!0,message:"请输入API请求路径",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],remark:[{required:!0,message:"请输入API注释",trigger:"blur"}]}}},mounted:function(){var e=JSON.parse(this.$route.query.data);e.supportMethods&&0!==e.supportMethods.length||(e.supportMethods=["ALL"]);var t="";e.supportContentType.forEach(function(e){t+=e+","}),e.supportContentType=t.substring(0,t.length-1),console.log(e),this.form=e},methods:{removeDomain:function(e){var t=this.form.apiOption.apiOptionUrls.indexOf(e);-1!==t&&this.form.apiOption.apiOptionUrls.splice(t,1)},addDomain:function(){this.form.apiOption.apiOptionUrls.push({url:""})},onSubmit:function(){var e=this;this.$refs.appForm.validate(function(t){if(!t)return!1;var r=JSON.parse(n()(e.form));r.supportMethods=r.supportMethods.filter(function(e){return"ALL"!==e}),r.supportMethods.length!==e.form.supportMethods.length&&(r.supportMethods=[]),r.supportContentType=r.supportContentType.split(","),r.apiOption.apiOptionUrls=r.apiOption.apiOptionUrls.filter(function(e){return e.url&&""!==e.url}),0!==r.apiOption.apiOptionUrls.length?(console.log(r),Object(l.d)(a.a.app.api.update+e.$route.query.id,"",r).then(function(t){0===t.code?e.$router.back(1):e.$message({message:t.msg,type:"warning"})})):e.$message({message:"请选择目标url",type:"warning"})})}}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dashboard"},[r("el-form",{ref:"appForm",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"API名字",prop:"name"}},[r("el-input",{attrs:{disabled:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"请求路径",prop:"path"}},[r("el-input",{model:{value:e.form.path,callback:function(t){e.$set(e.form,"path",t)},expression:"form.path"}})],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:"12"}},[r("el-form-item",{attrs:{label:"请求类型"}},[r("el-select",{attrs:{placeholder:"请选择请求类型"},model:{value:e.form.apiType,callback:function(t){e.$set(e.form,"apiType",t)},expression:"form.apiType"}},e._l(e.requestType,function(e,t){return r("el-option",{key:t,attrs:{label:t,value:e}})}))],1)],1),e._v(" "),r("el-col",{attrs:{span:"12"}},[r("el-form-item",{attrs:{label:"选择方法"}},[r("el-select",{attrs:{multiple:"",placeholder:"请选择支持的方法"},model:{value:e.form.supportMethods,callback:function(t){e.$set(e.form,"supportMethods",t)},expression:"form.supportMethods"}},e._l(e.methods,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}))],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"支持数据"}},[r("el-input",{attrs:{placeholder:"content-type,用逗号隔开"},model:{value:e.form.supportContentType,callback:function(t){e.$set(e.form,"supportContentType",t)},expression:"form.supportContentType"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"API标注",prop:"remark"}},[r("el-input",{model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return t.preventDefault(),e.addDomain(t)}}},[e._v("添加目标URL")])],1),e._v(" "),e._l(e.form.apiOption.apiOptionUrls,function(t,o){return r("el-form-item",{key:o,staticClass:"dy-domain",attrs:{label:"URL "+o}},[r("el-row",[r("el-col",{attrs:{span:"18"}},[r("el-input",{model:{value:t.url,callback:function(r){e.$set(t,"url",r)},expression:"domain.url"}})],1),e._v(" "),r("el-col",{attrs:{span:"6"}},[e.form.apiOption.apiOptionUrls.length>1?r("el-button",{staticStyle:{"margin-left":"6px"},attrs:{type:"warning",icon:"el-icon-close"},on:{click:function(r){r.preventDefault(),e.removeDomain(t)}}},[e._v("删除")]):e._e()],1)],1)],1)}),e._v(" "),r("div",{staticStyle:{width:"100%"}}),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("更新")]),e._v(" "),r("el-button",{on:{click:function(t){e.$router.back(1)}}},[e._v("取消")])],1)],2)],1)},staticRenderFns:[]};var m=r("VU/8")(i,u,!1,function(e){r("r6rs")},"data-v-7b50adf9",null);t.default=m.exports},r6rs:function(e,t){}});